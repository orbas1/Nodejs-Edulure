# New Backend Files

- `backend-nodejs/src/config/env.js` – environment validation and typed configuration export.
- `backend-nodejs/src/docs/openapi.json` – OpenAPI 3.0 specification consumed by Swagger UI and client SDK generation.
- `backend-nodejs/src/models/CommunityMemberModel.js`, `DomainEventModel.js`, `UserSessionModel.js` – new repositories supporting orchestration and auditing.
- `backend-nodejs/src/utils/httpResponse.js` – shared success/pagination response helper.
- `backend-nodejs/migrations/20241010120000_initial_schema.js` – Knex migration establishing users, communities, memberships, domain events, and session tables.
- `backend-nodejs/knexfile.cjs` – Knex CLI configuration.
- `.github/dependabot.yml` – automated dependency monitoring for backend, frontend, mobile, and GitHub Actions.
- `.nvmrc` – Node.js version pin for local and CI execution.
- `scripts/verify-node-version.mjs` – workspace runtime guard ensuring Node/npm versions and package manager choice are compliant before installs.
- `backend-nodejs/src/config/storage.js` – centralised Cloudflare R2 client configuration and endpoint export.
- `backend-nodejs/src/config/jwtKeyStore.js` – shared JWT signing key lookup, verification, and rotation metadata access.
- `backend-nodejs/src/services/StorageService.js`, `AssetService.js`, `AssetIngestionService.js` – storage abstraction, asset lifecycle orchestration, and conversion worker.
- `backend-nodejs/src/services/AntivirusService.js` – ClamAV-backed streaming scanner with caching, quarantine routing, and Prometheus instrumentation.
- `backend-nodejs/src/controllers/ContentController.js`, `routes/content.routes.js` – content API surface for upload sessions, ingestion, analytics, and telemetry.
- `backend-nodejs/src/models/ContentAssetModel.js`, `AssetConversionOutputModel.js`, `AssetIngestionJobModel.js`, `ContentAssetEventModel.js`, `ContentAuditLogModel.js`, `EbookProgressModel.js` – Knex repositories powering the content pipeline.
- `backend-nodejs/migrations/20241020130000_content_assets.js` – schema for assets, ingestion jobs, conversion outputs, events, audit logs, and ebook progress.
- `backend-nodejs/vitest.config.mjs`, `backend-nodejs/test/setupEnv.js`, `backend-nodejs/test/storageService.test.js` – Vitest harness and suites covering Cloudflare R2 storage behaviours.
- `backend-nodejs/scripts/rotate-jwt-keys.js` – operational CLI for generating and promoting JWT signing keys.
- `backend-nodejs/migrations/20241030140000_user_security_enhancements.js` – incremental migration adding lockout telemetry columns to `users` and provisioning the `user_email_verification_tokens` table.
- `backend-nodejs/src/models/EmailVerificationTokenModel.js` – repository layer for hashing, issuing, and consuming verification tokens with replacement semantics.
- `backend-nodejs/src/services/MailService.js` – SMTP-backed mailer that renders production templates for security communications.
- `backend-nodejs/src/services/EmailVerificationService.js` – orchestration service handling issuance, throttling, and consumption of verification tokens with domain event logging.
- `backend-nodejs/test/mailService.test.js` – Vitest coverage validating email templates and SMTP payload construction.
- `backend-nodejs/src/observability/requestContext.js` & `backend-nodejs/src/observability/metrics.js` – AsyncLocalStorage-backed correlation context and Prometheus metrics registry powering the new observability stack, plus `backend-nodejs/src/middleware/requestContext.js` for Express integration.
- `backend-nodejs/migrations/20241101090000_enhance_user_sessions.js` – migration enriching `user_sessions` with `last_used_at`, `rotated_at`, and `revoked_by` metadata for rotation governance.
- `backend-nodejs/src/services/SessionRegistry.js` – in-memory/session cache ensuring revoked sessions are denied without repeated database lookups.
- `backend-nodejs/test/sessionRegistry.test.js` – Vitest suite validating session cache behaviour, TTL eviction, and revocation handling.
- `backend-nodejs/migrations/20241105153000_data_hygiene.js` – migration adding retention policy/audit tables, owner membership triggers, and soft-delete columns for data hygiene automation.
- `backend-nodejs/seeds/001_bootstrap.js` – production-grade seed dataset covering verified roles, communities, asset lifecycle telemetry, and stale session cases for governance validation.
- `backend-nodejs/src/services/dataRetentionService.js` – policy-driven retention executor with audit logging used by scheduled hygiene jobs.
- `backend-nodejs/scripts/run-data-retention.js` – CLI wrapper for enforcing retention policies with dry-run/verbose flags.
- `backend-nodejs/src/jobs/dataRetentionJob.js` – managed cron scheduler coordinating retention enforcement with failure backoff and startup toggles.
- `backend-nodejs/test/dataRetentionService.test.js`, `backend-nodejs/test/dataRetentionJob.test.js` – Vitest coverage for the retention executor strategies and scheduler resilience.
- `backend-nodejs/migrations/20241107101500_feature_flags_and_runtime_config.js` – creates feature flag, audit, and runtime configuration tables with seed data.
- `backend-nodejs/src/models/FeatureFlagModel.js`, `backend-nodejs/src/models/ConfigurationEntryModel.js` – repositories exposing JSON-parsed flag/config metadata.
- `backend-nodejs/src/services/FeatureFlagService.js` – caching feature flag/runtime configuration orchestrator with metrics integration.
- `backend-nodejs/src/middleware/runtimeConfig.js`, `backend-nodejs/src/controllers/RuntimeConfigController.js`, `backend-nodejs/src/routes/runtimeConfig.routes.js` – Express plumbing exposing `/api/runtime` endpoints and request helpers.
- `backend-nodejs/scripts/runtime-config.js` – CLI generating flag/config snapshots for ops.
- `backend-nodejs/test/featureFlagService.test.js`, `backend-nodejs/test/runtimeConfigService.test.js` – Vitest coverage validating strategy evaluation and runtime config exposure.
- `backend-nodejs/eslint.config.mjs` – ESLint flat configuration enabling workspace-wide governance with Node/test aware rules.
- `backend-nodejs/scripts/provision-r2-buckets.js` – operational CLI that creates/validates Cloudflare R2 buckets with lifecycle, CORS, and tagging policies.
- `backend-nodejs/test/antivirusService.test.js` – Vitest suite exercising antivirus scanning, detection, caching, and storage streaming integrations.
- `backend-nodejs/migrations/20241112120000_payments_and_commerce.js` – Knex migration provisioning coupons, tax rates, orders, transactions, refunds, and audit tables with indexes for reconciliation performance.
- `backend-nodejs/src/models/CommerceCouponModel.js`, `CommerceTaxRateModel.js`, `PaymentOrderModel.js`, `PaymentTransactionModel.js`, `PaymentAuditLogModel.js`, `PaymentRefundModel.js` – repositories encapsulating the commerce ledger with helper queries for finance dashboards.
- `backend-nodejs/src/services/PaymentService.js` – production-ready payment orchestration (Stripe/PayPal intents, taxes, refunds, webhook verification, Prometheus metrics, audit logging).
- `backend-nodejs/src/controllers/PaymentController.js`, `backend-nodejs/src/routes/commerce.routes.js` – Express surface for order create/capture/refund plus webhook endpoints.
- `backend-nodejs/test/paymentService.test.js` – Vitest suite mocking Stripe/PayPal SDKs to validate coupon/tax calculations, refunds, and webhook handling.
- `backend-nodejs/test/setupMocks.js` – Shared Stripe/PayPal mock harness consumed by payment-focused Vitest suites.
