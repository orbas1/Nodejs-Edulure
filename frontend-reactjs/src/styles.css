@tailwind base;
@tailwind components;
@tailwind utilities;

@import './styles/tokens.css';

@layer base {
  :root {
    color-scheme: light dark;
    background-color: var(--color-surface);
    color: var(--color-text-primary);
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    background-color: var(--color-surface-muted);
    color: var(--color-text-primary);
    font-size: var(--font-size-base);
    line-height: 1.6;
    --density-radius-active: var(--density-radius-base);
    @apply antialiased;
  }

  body[data-theme='dark'] {
    background-color: var(--color-surface);
    color: var(--color-text-primary);
  }

  body[data-contrast='high'] {
    background-color: var(--color-surface-contrast);
    color: var(--color-text-contrast);
  }

  body[data-density='compact'] {
    --grid-gutter: clamp(0.75rem, 1.2vw, 1.5rem);
    --density-radius-active: var(--density-radius-compact);
    line-height: 1.45;
  }

  body[data-density='expanded'] {
    --grid-gutter: clamp(2rem, 2.8vw, 3.5rem);
    --density-radius-active: var(--density-radius-expanded);
    line-height: 1.75;
  }

  a {
    color: var(--color-text-highlight);
    transition: color var(--motion-duration-rapid) var(--motion-ease-entrance);
  }

  a:hover,
  a:focus-visible {
    color: var(--color-accent-strong);
  }

  a:focus-visible,
  button:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px var(--color-accent-muted), 0 0 0 5px var(--color-surface);
    border-radius: 999px;
  }

  .skip-to-content {
    position: absolute;
    left: -999px;
    top: auto;
    width: 1px;
    height: 1px;
    overflow: hidden;
    clip: rect(1px, 1px, 1px, 1px);
    white-space: nowrap;
  }

  .skip-to-content:focus {
    left: var(--space-lg);
    top: var(--space-lg);
    width: auto;
    height: auto;
    padding: var(--space-sm) var(--space-lg);
    background-color: var(--color-accent);
    color: var(--color-text-inverse);
    clip: auto;
    border-radius: 999px;
    box-shadow: 0 20px 45px -20px rgba(45, 98, 255, 0.45);
    z-index: 9999;
  }

  [data-motion='reduce'] * {
    transition-duration: var(--motion-duration-rapid) !important;
    animation-duration: var(--motion-duration-rapid) !important;
    animation-iteration-count: 1 !important;
  }
}

@layer utilities {
  .layout-grid {
    --grid-max-columns: auto-fit;
    display: grid;
    gap: var(--grid-gutter);
    grid-template-columns: repeat(
      var(--grid-max-columns),
      minmax(min(100%, var(--grid-column-min)), 1fr)
    );
  }

  .layout-grid[data-max-columns='2'] {
    --grid-max-columns: auto-fit;
  }

  .layout-grid[data-max-columns='3'] {
    --grid-max-columns: auto-fit;
  }

  @media (min-width: 48rem) {
    .layout-grid[data-max-columns='2'] {
      --grid-max-columns: 2;
    }
  }

  @media (min-width: 64rem) {
    .layout-grid[data-max-columns='3'] {
      --grid-max-columns: 3;
    }
  }
}

@layer components {
  .dashboard-shell {
    min-height: 100vh;
    background-color: var(--color-surface-muted);
    color: var(--color-text-primary);
  }

  .dashboard-aside {
    width: theme('spacing.72');
    @apply hidden shrink-0 border-r border-slate-200 bg-white/95 backdrop-blur transition-[width] duration-200 ease-in-out lg:flex lg:flex-col lg:shadow-sm;
  }

  .dashboard-aside--collapsed {
    width: theme('spacing.24');
  }

  .dashboard-card {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border-subtle);
    border-radius: var(--density-radius-active, 1.5rem);
    box-shadow: 0 20px 45px -20px rgba(15, 23, 42, 0.18);
  }

  .dashboard-card-muted {
    background-color: var(--color-surface-muted);
    border: 1px solid var(--color-border-subtle);
    border-radius: calc(var(--density-radius-active, 1.5rem) - 0.25rem);
  }

  .dashboard-section {
    @apply dashboard-card p-6;
  }

  .dashboard-kicker {
    @apply text-xs font-semibold uppercase tracking-wide text-slate-500;
  }

  .dashboard-title {
    @apply text-2xl font-semibold text-slate-900;
  }

  .dashboard-subtitle {
    @apply mt-2 text-sm text-slate-600;
  }

  .dashboard-pill {
    border-color: var(--color-border-subtle);
    color: var(--color-text-secondary);
    @apply rounded-full border px-4 py-2 text-xs font-semibold transition hover:border-primary hover:text-primary;
  }

  .dashboard-primary-pill {
    @apply rounded-full bg-primary px-4 py-2 text-xs font-semibold text-white shadow-sm transition hover:bg-primary-dark;
  }

  .dashboard-primary-pill:focus-visible {
    box-shadow: none;
    @apply ring-2 ring-primary/70 ring-offset-2 ring-offset-white;
  }

  body[data-contrast='high'] .dashboard-card,
  body[data-contrast='high'] .dashboard-card-muted {
    box-shadow: none;
    border-color: var(--color-border-contrast);
  }
}
